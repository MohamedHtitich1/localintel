# localintel

## Overview

**localintel** (Local Intelligence) is an R package that provides a
unified pipeline for **150+ subnational indicators across 14 thematic
domains** from Eurostat. Any Eurostat regional dataset — economy,
health, education, labour, demographics, tourism, transport,
environment, and more — can be fetched, harmonized, cascaded to NUTS 2,
scored, mapped, and exported through a single consistent workflow.

[![localintel pipeline: from raw Eurostat data to complete regional maps
across 235 NUTS-2
regions](reference/figures/hero-map.svg)](https://mhtitich.com/subnational)

|                                                                             |                                                                                                                                                                                                 |
|:---------------------------------------------------------------------------:|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  ![fetch](https://api.iconify.design/lucide/database.svg?color=%237c9885)   | **150+ Indicators** — Curated registries for 14 Eurostat domains with batch download and retry logic                                                                                            |
|  ![process](https://api.iconify.design/lucide/layers.svg?color=%237c9885)   | **Universal Processing** — Generic [`process_eurostat()`](https://mohamedhtitich1.github.io/localintel/reference/process_eurostat.md) plus domain-specific processors for instant harmonization |
| ![cascade](https://api.iconify.design/lucide/git-merge.svg?color=%237c9885) | **Data Cascading** — Intelligent propagation from country (NUTS 0) to regional (NUTS 2) with source-level tracking                                                                              |
|     ![viz](https://api.iconify.design/lucide/globe.svg?color=%237c9885)     | **Visualization** — Publication-ready maps with automatic best-level selection per country                                                                                                      |
|   ![export](https://api.iconify.design/lucide/upload.svg?color=%237c9885)   | **Export** — Tableau-ready GeoJSON, Excel, PDF maps, and RDS with enrichment and performance tags                                                                                               |

## Live Demo

> **See localintel in action** —
> [mhtitich.com/subnational](https://mhtitich.com/subnational) is an
> interactive dashboard built entirely with data processed through this
> package. It maps regional disparities across **235 European NUTS-2
> regions** from 2010–2024, with live indicator switching, animated
> timeline playback, and AI-generated regional insights.
>
> The pipeline is fully parametrizable and can be adapted to any
> indicator domain. **Interested in a custom deployment? [Get in
> touch.](mailto:m.ahtitich@outlook.com)**

## Installation

``` r
# Install from GitHub
# install.packages("devtools")
devtools::install_github("MohamedHtitich1/localintel")
```

## Quick Start

Fetch one indicator, cascade it to every NUTS-2 region, and plot — in
four lines:

``` r
library(localintel)

gdp_raw  <- get_nuts_level_robust("nama_10r_2gdp", level = 2, years = 2020:2024)
gdp      <- process_gdp(gdp_raw)
cascaded <- cascade_to_nuts2(gdp, vars = "gdp", years = 2020:2024)

plot_best_by_country_level(cascaded, get_nuts_geopolys(), var = "gdp", years = 2024:2024)
```

### Full Multi-Domain Workflow

Once you’re comfortable, scale up to multiple domains at once:

``` r
library(localintel)

# 1. Fetch data from multiple domains
econ  <- fetch_eurostat_batch(economy_codes(), level = 2, years = 2015:2024)
hlth  <- fetch_eurostat_batch(health_system_codes(), level = 2, years = 2015:2024)
lab   <- fetch_eurostat_batch(labour_codes(), level = 2, years = 2015:2024)

# 2. Process with domain-specific or generic processors
gdp       <- process_gdp(econ$gdp_nuts2)
beds      <- process_beds(hlth$beds)
unemp     <- process_unemployment_rate(lab$unemployment_rate)

# 3. Merge, cascade to NUTS2, and impute temporal gaps
all_data <- merge_datasets(gdp, beds, unemp)
cascaded <- cascade_to_nuts2(
  all_data,
  vars = c("gdp", "beds", "unemployment_rate"),
  years = 2015:2024,
  impute = TRUE,        # adaptive econometric imputation (PCHIP + ETS)
  forecast_to = 2025    # extend series with AIC-selected forecasts
)

# Check traceability
table(cascaded$src_gdp_level)  # 2=NUTS2, 1=NUTS1, 0=NUTS0
table(cascaded$imp_gdp_flag)   # 0=observed, 1=interpolated, 2=forecasted

# 4. Visualize
geopolys <- get_nuts_geopolys()
plot_best_by_country_level(cascaded, geopolys, var = "gdp", years = 2022:2024)

# 5. Export for Tableau
sf_all <- build_multi_var_sf(
  cascaded, geopolys,
  vars = c("gdp", "beds", "unemployment_rate"),
  years = 2015:2024,
  var_labels = regional_var_labels(),
  pillar_mapping = regional_domain_mapping()
)
export_to_geojson(sf_all, "output/multi_domain_nuts2.geojson")
```

## Why localintel?

If you work with Eurostat regional data, you’ve likely used the
[`eurostat`](https://cran.r-project.org/package=eurostat) or
[`restatapi`](https://cran.r-project.org/package=restatapi) packages.
They’re excellent for downloading individual datasets — but getting from
raw downloads to a complete, analysis-ready panel is where most of the
work begins. localintel picks up where they leave off:

|                 | `eurostat` / `restatapi`     | **localintel**                                                                                       |
|-----------------|------------------------------|------------------------------------------------------------------------------------------------------|
| **Scope**       | One dataset at a time        | 157 indicators across 15 domains in a single batch call                                              |
| **Processing**  | Raw data as-is               | Domain-specific processors select units, filter dimensions, and standardize columns automatically    |
| **Gaps**        | Missing regions stay missing | Cascade fills every NUTS-2 region from parent levels (100% geographic coverage) with source tracking |
| **Time series** | Gaps remain                  | PCHIP interpolation + ETS forecasting, with provenance flags on every cell                           |
| **Output**      | Data frame                   | Maps, GeoJSON (Tableau-ready), Excel, PDF map books — all from the same pipeline                     |

In short: `eurostat` gives you the data, localintel gives you the
complete analytical workflow on top of it.

## Domain Coverage

| Domain                   | Indicators | Key Datasets                                                     |
|--------------------------|------------|------------------------------------------------------------------|
| **Economy**              | 10         | GDP, GVA, gross fixed capital formation, household income        |
| **Demography**           | 13         | Population, life expectancy, fertility, mortality                |
| **Education**            | 11         | Attainment, students, training, early leavers, NEET              |
| **Labour Market**        | 13         | Employment, unemployment, activity rates, long-term unemployment |
| **Health System**        | 6          | Hospital beds, physicians, discharges, length of stay            |
| **Causes of Death**      | 16         | Standardised death rates, PYLL, infant mortality                 |
| **Tourism**              | 8          | Arrivals, nights spent, accommodation capacity                   |
| **Transport**            | 10         | Road, rail, air, maritime infrastructure and traffic             |
| **Environment**          | 7          | Municipal waste, energy, contaminated sites                      |
| **Science & Technology** | 11         | R&D expenditure, patents, HRST, high-tech employment             |
| **Poverty & Exclusion**  | 4          | At-risk-of-poverty, material deprivation, low work intensity     |
| **Agriculture**          | 5          | Crops, livestock, land use, milk production                      |
| **Business**             | 6          | SBS, business demography, local units                            |
| **Information Society**  | 6          | Internet access, broadband, e-commerce, e-government             |
| **Crime**                | 1          | Crimes recorded by police                                        |

Use
[`indicator_count()`](https://mohamedhtitich1.github.io/localintel/reference/indicator_count.md)
to get the exact total and per-domain breakdown.

## Key Features

### Data Cascading

The package automatically fills missing regional data by cascading from
parent NUTS levels:

    NUTS 0 (Country) → NUTS 1 (Major Regions) → NUTS 2 (Regions)

Every cascaded value is tracked via `src_<variable>_level` columns (2 =
original NUTS 2, 1 = from NUTS 1, 0 = from NUTS 0), enabling full
transparency and sensitivity analysis.

### Generic Processing

The
[`process_eurostat()`](https://mohamedhtitich1.github.io/localintel/reference/process_eurostat.md)
function handles **any** Eurostat dataset with flexible dimension
filtering:

``` r
# Custom indicator with arbitrary filters
custom <- process_eurostat(raw_data,
  filters = list(unit = "PC", sex = "T", age = "Y25-64"),
  out_col = "my_indicator"
)
```

### Visualization

Automatic “best level” selection for maps — displays NUTS 2 where
available, falls back to NUTS 1 / NUTS 0:

``` r
plot_best_by_country_level(cascaded, geopolys, var = "unemployment_rate",
  years = 2022:2024, title = "Unemployment Rate (%)", scale = "global")
```

### Tableau Integration

Full support for Tableau exports with country names, region labels,
population-weighted aggregations, and performance tags (Best/Worst by
country):

``` r
sf_enriched <- enrich_for_tableau(sf_all, pop_data, nuts2_names)
export_to_geojson(sf_enriched, "dashboard_export.geojson")
```

## Related Work

This package was developed as part of research on subnational regional
analysis in Europe. Related projects:

- [Subnational Health Disparities Map](https://mhtitich.com/subnational)
  — Interactive dashboard powered by localintel
- [w2m](https://github.com/MohamedHtitich1/w2m) — Composite indicator
  construction

## Contributing

Contributions are welcome! Please open an issue or submit a pull
request.

## License

MIT © Mohamed Htitich

## Citation

``` bibtex
@software{localintel,
  author = {Htitich, Mohamed},
  title = {localintel: Local Intelligence for Subnational Data Analysis},
  year = {2025},
  url = {https://github.com/MohamedHtitich1/localintel}
}
```

# Package index

## Package Overview

- [`localintel-package`](https://mohamedhtitich1.github.io/localintel/reference/localintel-package.md)
  [`localintel`](https://mohamedhtitich1.github.io/localintel/reference/localintel-package.md)
  : Local Intelligence for Subnational Data Analysis

## Indicator Registry

Curated registries of Eurostat dataset codes across 14 thematic domains
— 150+ indicators ready for seamless fetching and processing.

- [`all_regional_codes()`](https://mohamedhtitich1.github.io/localintel/reference/all_regional_codes.md)
  : All Regional Indicator Dataset Codes
- [`indicator_count()`](https://mohamedhtitich1.github.io/localintel/reference/indicator_count.md)
  : Count Available Regional Indicators
- [`economy_codes()`](https://mohamedhtitich1.github.io/localintel/reference/economy_codes.md)
  : Economy and Regional Accounts Dataset Codes
- [`demography_codes()`](https://mohamedhtitich1.github.io/localintel/reference/demography_codes.md)
  : Demography Dataset Codes
- [`education_codes()`](https://mohamedhtitich1.github.io/localintel/reference/education_codes.md)
  : Education Dataset Codes
- [`labour_codes()`](https://mohamedhtitich1.github.io/localintel/reference/labour_codes.md)
  : Labour Market Dataset Codes
- [`health_system_codes()`](https://mohamedhtitich1.github.io/localintel/reference/health_system_codes.md)
  [`causes_of_death_codes()`](https://mohamedhtitich1.github.io/localintel/reference/health_system_codes.md)
  : Eurostat Dataset Code Lists
- [`tourism_codes()`](https://mohamedhtitich1.github.io/localintel/reference/tourism_codes.md)
  : Tourism Dataset Codes
- [`transport_codes()`](https://mohamedhtitich1.github.io/localintel/reference/transport_codes.md)
  : Transport Dataset Codes
- [`environment_codes()`](https://mohamedhtitich1.github.io/localintel/reference/environment_codes.md)
  : Environment and Energy Dataset Codes
- [`science_codes()`](https://mohamedhtitich1.github.io/localintel/reference/science_codes.md)
  : Science and Technology Dataset Codes
- [`poverty_codes()`](https://mohamedhtitich1.github.io/localintel/reference/poverty_codes.md)
  : Poverty and Social Exclusion Dataset Codes
- [`agriculture_codes()`](https://mohamedhtitich1.github.io/localintel/reference/agriculture_codes.md)
  : Agriculture Dataset Codes
- [`business_codes()`](https://mohamedhtitich1.github.io/localintel/reference/business_codes.md)
  : Business Statistics Dataset Codes
- [`information_society_codes()`](https://mohamedhtitich1.github.io/localintel/reference/information_society_codes.md)
  : Information Society Dataset Codes
- [`crime_codes()`](https://mohamedhtitich1.github.io/localintel/reference/crime_codes.md)
  : Crime Dataset Codes

## Data Fetching

Robust wrappers for the Eurostat API — fetch single or batch datasets at
any NUTS level with automatic retry and caching.

- [`get_nuts2()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2.md)
  [`get_nuts_level()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2.md)
  [`get_nuts_level_robust()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2.md)
  [`get_nuts_level_safe()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2.md)
  [`fetch_eurostat_batch()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2.md)
  [`drop_empty()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2.md)
  : Eurostat Data Fetching Functions
- [`clear_localintel_cache()`](https://mohamedhtitich1.github.io/localintel/reference/clear_localintel_cache.md)
  : Clear Session Cache

## Reference Data

NUTS boundary geometries, hierarchical lookup tables, and population
data for spatial joins and cascading.

- [`get_nuts2_ref()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2_ref.md)
  [`get_nuts_geo()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2_ref.md)
  [`get_nuts_geopolys()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2_ref.md)
  [`get_nuts2_names()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2_ref.md)
  [`get_population_nuts2()`](https://mohamedhtitich1.github.io/localintel/reference/get_nuts2_ref.md)
  : NUTS Reference Data Functions
- [`keep_eu27()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  [`eu27_codes()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  [`nuts_country_names()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  [`add_country_name()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  : EU27 Country Filtering and Naming Functions

## Data Processing

Transform raw Eurostat downloads into analysis-ready tables. Use the
generic processor for any dataset, or domain-specific convenience
functions for common indicators.

- [`process_eurostat()`](https://mohamedhtitich1.github.io/localintel/reference/process_eurostat.md)
  : Process Any Eurostat Dataset
- [`process_gdp()`](https://mohamedhtitich1.github.io/localintel/reference/process_gdp.md)
  : Process GDP Data
- [`process_employment()`](https://mohamedhtitich1.github.io/localintel/reference/process_employment.md)
  : Process Employment Data
- [`process_unemployment_rate()`](https://mohamedhtitich1.github.io/localintel/reference/process_unemployment_rate.md)
  : Process Unemployment Rate Data
- [`process_population()`](https://mohamedhtitich1.github.io/localintel/reference/process_population.md)
  : Process Population Data
- [`process_life_expectancy()`](https://mohamedhtitich1.github.io/localintel/reference/process_life_expectancy.md)
  : Process Life Expectancy Data
- [`process_tourism_nights()`](https://mohamedhtitich1.github.io/localintel/reference/process_tourism_nights.md)
  : Process Tourism Nights Spent Data
- [`process_rd_expenditure()`](https://mohamedhtitich1.github.io/localintel/reference/process_rd_expenditure.md)
  : Process R&D Expenditure Data
- [`process_education_attainment()`](https://mohamedhtitich1.github.io/localintel/reference/process_education_attainment.md)
  : Process Education Attainment Data
- [`process_poverty_rate()`](https://mohamedhtitich1.github.io/localintel/reference/process_poverty_rate.md)
  : Process Poverty Rate Data
- [`process_waste()`](https://mohamedhtitich1.github.io/localintel/reference/process_waste.md)
  : Process Municipal Waste Data
- [`process_beds()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`process_physicians()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`process_los()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`process_hos_days()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`process_disch_inp()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`process_disch_day()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`process_cod()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`process_health_perceptions()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`merge_datasets()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`compute_composite()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  [`transform_and_score()`](https://mohamedhtitich1.github.io/localintel/reference/process_beds.md)
  : Data Processing Functions

## Data Cascading

Fill missing regional data by propagating from parent NUTS levels (NUTS
0 → NUTS 1 → NUTS 2) with source-level tracking.

- [`cascade_to_nuts2()`](https://mohamedhtitich1.github.io/localintel/reference/cascade_to_nuts2.md)
  : Cascade Data to NUTS2 (Generic / Domain-Agnostic)
- [`cascade_to_nuts2_and_compute()`](https://mohamedhtitich1.github.io/localintel/reference/cascade_to_nuts2_and_compute.md)
  [`cascade_to_nuts2_light()`](https://mohamedhtitich1.github.io/localintel/reference/cascade_to_nuts2_and_compute.md)
  [`balance_panel()`](https://mohamedhtitich1.github.io/localintel/reference/cascade_to_nuts2_and_compute.md)
  : Data Cascading Functions

## Econometric Imputation

Advanced time series imputation combining PCHIP interpolation for
internal gaps with autoregressive ETS forecasting for future periods —
with flag-based provenance tracking.

- [`interp_pchip_flag()`](https://mohamedhtitich1.github.io/localintel/reference/interp_pchip_flag.md)
  : PCHIP Interpolation with Constant Endpoints
- [`forecast_autoregressive()`](https://mohamedhtitich1.github.io/localintel/reference/forecast_autoregressive.md)
  : Autoregressive Forecast for Future Observations
- [`impute_series()`](https://mohamedhtitich1.github.io/localintel/reference/impute_series.md)
  : Full Imputation Pipeline

## Visualization

Build spatial objects and render publication-ready tmap facets —
automatic best-level selection per country-year.

- [`build_display_sf()`](https://mohamedhtitich1.github.io/localintel/reference/build_display_sf.md)
  [`lc_build_display_sf()`](https://mohamedhtitich1.github.io/localintel/reference/build_display_sf.md)
  [`plot_best_by_country_level()`](https://mohamedhtitich1.github.io/localintel/reference/build_display_sf.md)
  [`build_multi_var_sf()`](https://mohamedhtitich1.github.io/localintel/reference/build_display_sf.md)
  [`level_col_for()`](https://mohamedhtitich1.github.io/localintel/reference/build_display_sf.md)
  [`level_cols_for()`](https://mohamedhtitich1.github.io/localintel/reference/build_display_sf.md)
  : Visualization Functions

## Export & Labels

Export enriched GeoJSON for Tableau, multi-sheet Excel workbooks, RDS
snapshots, and multi-page PDF map books. Includes label registries for
all 14 domains.

- [`export_to_geojson()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  [`export_to_excel()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  [`export_to_rds()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  [`save_maps_to_pdf()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  [`enrich_for_tableau()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  [`health_var_labels()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  [`health_pillar_mapping()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  [`cod_labels()`](https://mohamedhtitich1.github.io/localintel/reference/export_to_geojson.md)
  : Export Functions
- [`regional_var_labels()`](https://mohamedhtitich1.github.io/localintel/reference/regional_var_labels.md)
  : Regional Variable Labels (All Domains)
- [`regional_domain_mapping()`](https://mohamedhtitich1.github.io/localintel/reference/regional_domain_mapping.md)
  : Regional Domain Mapping (All Domains)

## Utilities

Helper functions for safe transformations, min-max scaling,
interpolation, EU27 filtering, and country-name enrichment.

- [`keep_eu27()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  [`eu27_codes()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  [`nuts_country_names()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  [`add_country_name()`](https://mohamedhtitich1.github.io/localintel/reference/keep_eu27.md)
  : EU27 Country Filtering and Naming Functions
- [`safe_log10()`](https://mohamedhtitich1.github.io/localintel/reference/safe_log10.md)
  [`safe_log2()`](https://mohamedhtitich1.github.io/localintel/reference/safe_log10.md)
  [`scale_0_100()`](https://mohamedhtitich1.github.io/localintel/reference/safe_log10.md)
  [`rescale_minmax()`](https://mohamedhtitich1.github.io/localintel/reference/safe_log10.md)
  : Safe Logarithm and Scaling Functions
- [`interp_const_ends_flag()`](https://mohamedhtitich1.github.io/localintel/reference/interp_const_ends_flag.md)
  [`standardize_time()`](https://mohamedhtitich1.github.io/localintel/reference/interp_const_ends_flag.md)
  : Data Interpolation and Time Utilities
- [`normalize_eurostat_cols()`](https://mohamedhtitich1.github.io/localintel/reference/normalize_eurostat_cols.md)
  : Normalize Eurostat Column Names

# Articles

### Getting Started

- [Getting Started with
  localintel](https://mohamedhtitich1.github.io/localintel/articles/localintel.md):

### Tutorials

- [Multi-Domain Regional
  Analysis](https://mohamedhtitich1.github.io/localintel/articles/workflow.md):

### Help

- [FAQ &
  Troubleshooting](https://mohamedhtitich1.github.io/localintel/articles/faq.md):
